#:kivy 1.0.9

#:import label kivy.uix.label
#:import sla kivy.adapters.simplelistadapter
#:import c controller
#:import gui gui

<SaneLabel>:
    size_hint_y: None
    text_size: self.width, None

<LogEntry>:
    font_name: 'DroidSansMono'

<IndicatorView>
    serial_choices: id_serial_choices
    orientation: 'horizontal'
    BoxLayout:
        id: id_serial_choices
        orientation: 'horizontal'
        size_hint: (0.75, 1)
    Label:
        size_hint: (0.05, 1)
    SaneLabel:
        size_hint: (0.1, 1)

        text: self.parent.inbound_traffic_text
    SaneLabel:
        size_hint: (0.1, 1)
        text: self.parent.outbound_traffic_text


<LogsView>:
    logs_list: id_logs_list

    ListView:
        id: id_logs_list
        adapter:
            sla.SimpleListAdapter(
            data=[],
            cls=gui.LogEntry)

<RootView>:
    debug_panel: id_debug_panel
    settings:    id_settings
    indicators:  id_indicators

    orientation: 'vertical'
    TabbedPanel:
        size_hint: (1, 0.93)
        do_default_tab: False
        TabbedPanelItem:
            text: "Debug"
            DebugView:
                id: id_debug_panel
        TabbedPanelItem:
            text: "Settings"
            SettingsView:
                id: id_settings
    IndicatorView:
        size_hint: (1, 0.07)
        id: id_indicators

<SettingsText>:
    padding_y: ( self.height - self.line_height ) / 2
    multiline: False
    hint_text: 'Loading...'
    font_size: '20sp'

<SettingsView>:
    box_time:      id_box_time
    box_uid:       id_box_uid
    box_node_type: id_box_node_type
    box_balance:   id_box_balance
    orientation: 'vertical'
    spacing: 10
    BoxLayout: # TIME
        size_hint: (1, 0.1)
        orientation: 'horizontal'
        SettingsText:
            size_hint: (0.5, 1)
            id: id_box_time
            readonly: True
        Button:
            size_hint: (0.5, 1)
            text:'Sync time with Computer'
            on_press: c.get.sync_time()

    BoxLayout: # uid and box type
        size_hint: (1, 0.1)
        orientation: 'horizontal'
        SettingsText:
            size_hint: (0.25, 1)
            id: id_box_uid
        SettingsText:
            size_hint: (0.25, 1)
            id: id_box_node_type
        Button:
            size_hint: (0.5, 1)
            text:'Set uid and node type'
            on_press: c.get.set_uid_node_type()
    BoxLayout: # uid and box type
        size_hint: (1, 0.1)
        orientation: 'horizontal'
        SettingsText:
            size_hint: (0.5, 1)
            id: id_box_balance
        Button:
            size_hint: (0.5, 1)
            text:'Set balance'
            on_press: c.get.set_balance()
    Label:

<DebugView>:
    logs: id_logs.logs_list
    eeprom_addr: id_eeprom_addr

    orientation: 'horizontal'
    spacing: 10

    BoxLayout:
        size_hint: (.35,1)
        orientation: 'vertical'
        spacing: 10
        Button:
            size_hint: (1, 0.1)
            text: 'Clear screen'
            on_press: c.get.clear_logs()
        Button:
            size_hint: (1, 0.1)
            text: 'Ping'
            on_press: c.get.send_ping()
        BoxLayout:
            size_hint: (1, 0.1)
            orientation: 'horizontal'
            TextInput:
                id: id_eeprom_addr
                size_hint: (0.4, 1)
                padding_y: (self.height - self.line_height) / 2
                multiline: False
                hint_text: 'eeprom'
            Button:
                size_hint: (0.2, 1)
                text: 'float'
                on_press: c.get.read_eeprom('float')
            Button:
                size_hint: (0.2, 1)
                text: 'uint32'
                on_press: c.get.read_eeprom('uint32')
            Button:
                size_hint: (0.2, 1)
                text: 'byte'
                on_press: c.get.read_eeprom('byte')

        Button:
            size_hint: (1, 0.1)
            text: 'Cron stats'
            on_press: c.get.cron_stats()
        Button:
            size_hint: (1, 0.1)
            text: 'Probe memory'
            on_press: c.get.get_memory()
        Button:
            size_hint: (1, 0.1)
            text: 'Reboot'
            on_press: c.get.reset_pic()
        Label:

    BoxLayout:
        size_hint: (.65,1)
        orientation: 'vertical'

        LogsView:
            size_hint: (1, 0.9)
            id: id_logs


